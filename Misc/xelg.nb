(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     14518,        357]
NotebookOptionsPosition[     13685,        326]
NotebookOutlinePosition[     14039,        342]
CellTagsIndexPosition[     13996,        339]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"a", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{3.547221567297187*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SafePrimeQ", ":=", 
    RowBox[{
     RowBox[{"PrimeQ", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#1", "-", "1"}], ")"}], "/", 
       RowBox[{"(", "#2", ")"}]}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Prime", "[", "i", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Select", "[", 
  RowBox[{"%", ",", 
   RowBox[{
    RowBox[{"SafePrimeQ", "[", 
     RowBox[{"#", ",", "a"}], "]"}], "&"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.547220110327629*^9, 3.547220188449665*^9}, {
  3.547220399864273*^9, 3.547220505962908*^9}, {3.547220546671329*^9, 
  3.547220693181972*^9}, {3.547220728247163*^9, 3.5472207797763433`*^9}, {
  3.547221569650442*^9, 3.547221585515635*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "3", ",", "5", ",", "7", ",", "11", ",", "13", ",", "17", ",", 
   "19", ",", "23", ",", "29", ",", "31", ",", "37", ",", "41", ",", "43", 
   ",", "47", ",", "53", ",", "59", ",", "61", ",", "67", ",", "71", ",", 
   "73", ",", "79", ",", "83", ",", "89", ",", "97", ",", "101", ",", "103", 
   ",", "107", ",", "109", ",", "113", ",", "127", ",", "131", ",", "137", 
   ",", "139", ",", "149", ",", "151", ",", "157", ",", "163", ",", "167", 
   ",", "173", ",", "179", ",", "181", ",", "191", ",", "193", ",", "197", 
   ",", "199", ",", "211", ",", "223", ",", "227", ",", "229", ",", "233", 
   ",", "239", ",", "241", ",", "251", ",", "257", ",", "263", ",", "269", 
   ",", "271", ",", "277", ",", "281", ",", "283", ",", "293", ",", "307", 
   ",", "311", ",", "313", ",", "317", ",", "331", ",", "337", ",", "347", 
   ",", "349", ",", "353", ",", "359", ",", "367", ",", "373", ",", "379", 
   ",", "383", ",", "389", ",", "397", ",", "401", ",", "409", ",", "419", 
   ",", "421", ",", "431", ",", "433", ",", "439", ",", "443", ",", "449", 
   ",", "457", ",", "461", ",", "463", ",", "467", ",", "479", ",", "487", 
   ",", "491", ",", "499", ",", "503", ",", "509", ",", "521", ",", "523", 
   ",", "541"}], "}"}]], "Output",
 CellChangeTimes->{{3.547220123649084*^9, 3.54722017903083*^9}, 
   3.54722041087659*^9, 3.547220457095436*^9, 3.547220495669394*^9, {
   3.547220552175436*^9, 3.5472207804916353`*^9}, {3.547221573870914*^9, 
   3.5472215906820097`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "13", ",", "29", ",", "53", ",", "149", ",", "173", ",", "269", ",", "293", 
   ",", "317", ",", "389", ",", "509"}], "}"}]], "Output",
 CellChangeTimes->{{3.547220123649084*^9, 3.54722017903083*^9}, 
   3.54722041087659*^9, 3.547220457095436*^9, 3.547220495669394*^9, {
   3.547220552175436*^9, 3.5472207804916353`*^9}, {3.547221573870914*^9, 
   3.547221590685587*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"p", "=", "173"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "-", "1"}], ")"}], "/", "a"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Range", "[", 
   RowBox[{"1", ",", "p"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{"%", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"MultiplicativeOrder", "[", 
       RowBox[{"#", ",", "p"}], "]"}], "\[Equal]", "a"}], "&"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"First", "[", "%", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ga", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PowerMod", "[", 
      RowBox[{"h", ",", "i", ",", "p"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"a", "-", "1"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Range", "[", 
   RowBox[{"1", ",", "p"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{"%", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"MultiplicativeOrder", "[", 
       RowBox[{"#", ",", "p"}], "]"}], "\[Equal]", 
      RowBox[{"(", 
       RowBox[{"a", "/", "2"}], ")"}]}], "&"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h2", "=", 
   RowBox[{"First", "[", "%", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ga2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"PowerMod", "[", 
      RowBox[{"h2", ",", "i", ",", "p"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "/", "2"}], ")"}], "-", "1"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Range", "[", 
   RowBox[{"1", ",", "p"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{"%", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"MultiplicativeOrder", "[", 
       RowBox[{"#", ",", "p"}], "]"}], "\[Equal]", "q"}], "&"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"First", "[", "%", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gq", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"PowerMod", "[", 
       RowBox[{"g", ",", "i", ",", "p"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"q", "-", "1"}]}], "}"}]}], "]"}], "//", "Union"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QR", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"PowerMod", "[", 
       RowBox[{"i", ",", "2", ",", "p"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"p", "-", "1"}]}], "}"}]}], "]"}], "//", "Union"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Intersection", "[", 
  RowBox[{"Ga", ",", "QR"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Intersection", "[", 
   RowBox[{"Ga", ",", "Gq"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PowerMod", "[", 
     RowBox[{"#", ",", "q", ",", "p"}], "]"}], "&"}], "/@", "Ga"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.547220782747617*^9, 3.547220908886561*^9}, {
  3.5472209637151012`*^9, 3.54722101127155*^9}, {3.547221044624213*^9, 
  3.547221266287036*^9}, {3.547221298135087*^9, 3.5472214408522797`*^9}, {
  3.5472215229948893`*^9, 3.547221561876526*^9}, {3.547221597510414*^9, 
  3.54722162213384*^9}, {3.547226860771496*^9, 3.547226882400997*^9}, {
  3.547226924965316*^9, 3.547226978972577*^9}, {3.547227010160453*^9, 
  3.5472270502422857`*^9}, {3.547227101058827*^9, 3.547227140736109*^9}, {
  3.547227183948567*^9, 3.547227184291209*^9}, {3.547227222683393*^9, 
  3.547227260088478*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "80", ",", "172", ",", "93"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5472210134589663`*^9, {3.5472210487872562`*^9, 3.547221054139757*^9}, {
   3.547221086692462*^9, 3.547221227070982*^9}, {3.5472212605267267`*^9, 
   3.54722144165687*^9}, {3.5472214916035137`*^9, 3.547221545384945*^9}, {
   3.547221598328142*^9, 3.547221622499744*^9}, 3.547226883462244*^9, {
   3.547226918489565*^9, 3.547226947244542*^9}, {3.547226987993557*^9, 
   3.547227047209202*^9}, 3.547227142122201*^9, 3.547227185363311*^9, {
   3.547227223135337*^9, 3.5472272272664633`*^9}, 3.547227261056326*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "172"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5472210134589663`*^9, {3.5472210487872562`*^9, 3.547221054139757*^9}, {
   3.547221086692462*^9, 3.547221227070982*^9}, {3.5472212605267267`*^9, 
   3.54722144165687*^9}, {3.5472214916035137`*^9, 3.547221545384945*^9}, {
   3.547221598328142*^9, 3.547221622499744*^9}, 3.547226883462244*^9, {
   3.547226918489565*^9, 3.547226947244542*^9}, {3.547226987993557*^9, 
   3.547227047209202*^9}, 3.547227142122201*^9, 3.547227185363311*^9, {
   3.547227223135337*^9, 3.5472272272664633`*^9}, 3.547227261059309*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "6", ",", "10", ",", "14", ",", "16", ",", "22", ",", "23", ",", 
   "29", ",", "36", ",", "43", ",", "47", ",", "51", ",", "52", ",", "57", 
   ",", "60", ",", "81", ",", "83", ",", "84", ",", "85", ",", "95", ",", 
   "96", ",", "100", ",", "106", ",", "109", ",", "117", ",", "118", ",", 
   "119", ",", "124", ",", "132", ",", "133", ",", "135", ",", "136", ",", 
   "138", ",", "139", ",", "140", ",", "142", ",", "148", ",", "149", ",", 
   "152", ",", "158", ",", "160", ",", "164", ",", "169"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5472210134589663`*^9, {3.5472210487872562`*^9, 3.547221054139757*^9}, {
   3.547221086692462*^9, 3.547221227070982*^9}, {3.5472212605267267`*^9, 
   3.54722144165687*^9}, {3.5472214916035137`*^9, 3.547221545384945*^9}, {
   3.547221598328142*^9, 3.547221622499744*^9}, 3.547226883462244*^9, {
   3.547226918489565*^9, 3.547226947244542*^9}, {3.547226987993557*^9, 
   3.547227047209202*^9}, 3.547227142122201*^9, 3.547227185363311*^9, {
   3.547227223135337*^9, 3.5472272272664633`*^9}, 3.5472272610619793`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "4", ",", "6", ",", "9", ",", "10", ",", "13", ",", "14", ",", 
   "15", ",", "16", ",", "21", ",", "22", ",", "23", ",", "24", ",", "25", 
   ",", "29", ",", "31", ",", "33", ",", "34", ",", "35", ",", "36", ",", 
   "37", ",", "38", ",", "40", ",", "41", ",", "43", ",", "47", ",", "49", 
   ",", "51", ",", "52", ",", "54", ",", "55", ",", "56", ",", "57", ",", 
   "60", ",", "64", ",", "67", ",", "73", ",", "77", ",", "78", ",", "81", 
   ",", "83", ",", "84", ",", "85", ",", "88", ",", "89", ",", "90", ",", 
   "92", ",", "95", ",", "96", ",", "100", ",", "106", ",", "109", ",", "113",
    ",", "116", ",", "117", ",", "118", ",", "119", ",", "121", ",", "122", 
   ",", "124", ",", "126", ",", "130", ",", "132", ",", "133", ",", "135", 
   ",", "136", ",", "137", ",", "138", ",", "139", ",", "140", ",", "142", 
   ",", "144", ",", "148", ",", "149", ",", "150", ",", "151", ",", "152", 
   ",", "157", ",", "158", ",", "159", ",", "160", ",", "163", ",", "164", 
   ",", "167", ",", "169", ",", "172"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5472210134589663`*^9, {3.5472210487872562`*^9, 3.547221054139757*^9}, {
   3.547221086692462*^9, 3.547221227070982*^9}, {3.5472212605267267`*^9, 
   3.54722144165687*^9}, {3.5472214916035137`*^9, 3.547221545384945*^9}, {
   3.547221598328142*^9, 3.547221622499744*^9}, 3.547226883462244*^9, {
   3.547226918489565*^9, 3.547226947244542*^9}, {3.547226987993557*^9, 
   3.547227047209202*^9}, 3.547227142122201*^9, 3.547227185363311*^9, {
   3.547227223135337*^9, 3.5472272272664633`*^9}, 3.547227261064983*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "172"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5472210134589663`*^9, {3.5472210487872562`*^9, 3.547221054139757*^9}, {
   3.547221086692462*^9, 3.547221227070982*^9}, {3.5472212605267267`*^9, 
   3.54722144165687*^9}, {3.5472214916035137`*^9, 3.547221545384945*^9}, {
   3.547221598328142*^9, 3.547221622499744*^9}, 3.547226883462244*^9, {
   3.547226918489565*^9, 3.547226947244542*^9}, {3.547226987993557*^9, 
   3.547227047209202*^9}, 3.547227142122201*^9, 3.547227185363311*^9, {
   3.547227223135337*^9, 3.5472272272664633`*^9}, 3.547227261067292*^9}],

Cell[BoxData[
 RowBox[{"{", "1", "}"}]], "Output",
 CellChangeTimes->{
  3.5472210134589663`*^9, {3.5472210487872562`*^9, 3.547221054139757*^9}, {
   3.547221086692462*^9, 3.547221227070982*^9}, {3.5472212605267267`*^9, 
   3.54722144165687*^9}, {3.5472214916035137`*^9, 3.547221545384945*^9}, {
   3.547221598328142*^9, 3.547221622499744*^9}, 3.547226883462244*^9, {
   3.547226918489565*^9, 3.547226947244542*^9}, {3.547226987993557*^9, 
   3.547227047209202*^9}, 3.547227142122201*^9, 3.547227185363311*^9, {
   3.547227223135337*^9, 3.5472272272664633`*^9}, 3.547227261069572*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "93", ",", "172", ",", "80"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5472210134589663`*^9, {3.5472210487872562`*^9, 3.547221054139757*^9}, {
   3.547221086692462*^9, 3.547221227070982*^9}, {3.5472212605267267`*^9, 
   3.54722144165687*^9}, {3.5472214916035137`*^9, 3.547221545384945*^9}, {
   3.547221598328142*^9, 3.547221622499744*^9}, 3.547226883462244*^9, {
   3.547226918489565*^9, 3.547226947244542*^9}, {3.547226987993557*^9, 
   3.547227047209202*^9}, 3.547227142122201*^9, 3.547227185363311*^9, {
   3.547227223135337*^9, 3.5472272272664633`*^9}, 3.547227261071885*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.5472269224608593`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5472213203096313`*^9, 3.547221321836277*^9}}]
},
WindowSize->{985, 977},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 6, \
2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 109, 3, 27, "Input"],
Cell[CellGroupData[{
Cell[691, 27, 922, 26, 88, "Input"],
Cell[1616, 55, 1529, 23, 73, "Output"],
Cell[3148, 80, 413, 8, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3598, 93, 4086, 120, 418, "Input"],
Cell[7687, 215, 631, 10, 27, "Output"],
Cell[8321, 227, 609, 10, 27, "Output"],
Cell[8933, 239, 1109, 17, 43, "Output"],
Cell[10045, 258, 1621, 24, 58, "Output"],
Cell[11669, 284, 609, 10, 27, "Output"],
Cell[12281, 296, 584, 9, 27, "Output"],
Cell[12868, 307, 631, 10, 27, "Output"]
}, Open  ]],
Cell[13514, 320, 70, 1, 27, "Input"],
Cell[13587, 323, 94, 1, 27, "Input"]
}
]
*)

(* End of internal cache information *)
