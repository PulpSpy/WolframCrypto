(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     27924,        639]
NotebookOptionsPosition[     26073,        603]
NotebookOutlinePosition[     26488,        619]
CellTagsIndexPosition[     26445,        616]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Lagrange Polynomials", "Section",
 CellChangeTimes->{{3.877861177229774*^9, 
  3.877861184681369*^9}},ExpressionUUID->"97238c83-4fd0-4175-bfec-\
ee253e351e0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Setting", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"q1", "=", "11"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ModExpZq", "[", 
     RowBox[{"ggg_", ",", "aaa_"}], "]"}], ":=", 
    RowBox[{"PowerMod", "[", 
     RowBox[{"ggg", ",", "aaa", ",", "q1"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "3", " ", "is", " ", "a", " ", "5", "th", " ", "Root", " ", "of", " ", 
     "Unity", " ", "for", " ", "Z_", "11", " ", 
     RowBox[{"(", 
      RowBox[{"not", " ", "computed"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"index", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"basis", "=", 
     RowBox[{"ModExpZq", "[", 
      RowBox[{"w", ",", "index"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Functions", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LagrangeCoefficient", "[", 
     RowBox[{"basis_", ",", "index_", ",", "q_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"num", ",", "denomInv", ",", "poly"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"num", "=", 
        RowBox[{"PolynomialMod", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "#"}], ")"}], "&"}], ",", "basis"}], "]"}], 
          ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"num", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"Times", "@@", 
           RowBox[{"Drop", "[", 
            RowBox[{"num", ",", 
             RowBox[{"{", "index", "}"}]}], "]"}]}], ",", " ", 
          RowBox[{"Modulus", "\[Rule]", "q"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"denomInv", "=", 
        RowBox[{"PowerMod", "[", 
         RowBox[{
          RowBox[{"num", "/.", 
           RowBox[{"{", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"Part", "[", 
              RowBox[{"basis", ",", "index"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"-", "1"}], ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"poly", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"num", "*", "denomInv"}], ",", 
          RowBox[{"Modulus", "\[Rule]", "q"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LagrangeBasis", "[", 
     RowBox[{"bb_", ",", "q_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"LagrangeCoefficient", "[", 
       RowBox[{"bb", ",", "i", ",", "q"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "bb", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PolynomialTransformLC", "[", 
     RowBox[{"basis_", ",", "data_", ",", "q_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"basis", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"Modulus", "\[Rule]", "q"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "basis", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"Total", "[", "temp", "]"}], ",", 
         RowBox[{"Modulus", "\[Rule]", "q"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8778854746115217`*^9, 3.8778854805430403`*^9}, {
   3.877886016581541*^9, 3.877886033094494*^9}, {3.8778861190806217`*^9, 
   3.877886119343053*^9}, {3.8778873668368063`*^9, 3.877887369162572*^9}, {
   3.877887949123122*^9, 3.877887955244068*^9}, {3.8778955864675617`*^9, 
   3.8778955969008017`*^9}, 3.8778992136123867`*^9, 3.877969237045815*^9, {
   3.877969313009725*^9, 3.877969350277276*^9}, 3.8779703449258623`*^9, {
   3.878059257162282*^9, 3.878059276284975*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"71432c66-8a6c-439d-a415-a6b645790171"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8778611878605947`*^9, 3.877861437783834*^9}, {
   3.877861507266698*^9, 3.877861511417925*^9}, {3.877861655080896*^9, 
   3.8778617428875513`*^9}, {3.877861836570084*^9, 3.877861877852483*^9}, {
   3.8778619354009237`*^9, 3.877861969396961*^9}, {3.8778622805358458`*^9, 
   3.877862318794361*^9}, {3.8778854073180027`*^9, 3.877885602116954*^9}, {
   3.8778859304399233`*^9, 3.8778859437599907`*^9}, {3.877885989751598*^9, 
   3.877885999497512*^9}, {3.8778860389342127`*^9, 3.8778860425317793`*^9}, {
   3.87788613386166*^9, 3.87788613437862*^9}, {3.8778864106401987`*^9, 
   3.877886416437059*^9}, {3.877887407027223*^9, 3.877887425570434*^9}, {
   3.8778879272294407`*^9, 3.8778879340557547`*^9}, 3.8778879796638203`*^9, 
   3.877895581679041*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"1f01297b-db1f-4438-b754-dffb720aaaf1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Lagrange", " ", "Basis", " ", "for", " ", "w"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LagrangeBasis", "[", 
     RowBox[{"basis", ",", "q1"}], "]"}], "//", "MatrixForm"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Check", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"KroneckerDelta", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Length", "[", "basis", "]"}], ",", 
        RowBox[{"Length", "[", "basis", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{
        RowBox[{"InterpolatingPolynomial", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"basis", ",", "#"}], "}"}], "]"}], ",", "x"}], "]"}], ",", 
        RowBox[{"Modulus", "\[Rule]", "q1"}]}], "]"}], "&"}], "/@", "%"}], "==", 
    RowBox[{"LagrangeBasis", "[", 
     RowBox[{"basis", ",", "q1"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Data", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "3", ",", "3", ",", "7"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Data", " ", "in", " ", "a", " ", "Naive", " ", "Polynomial", " ", 
     "Vector"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"points", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"index", ",", "data"}], "}"}], "//", "Transpose"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"PolynomialTransformLC", "[", 
    RowBox[{
     RowBox[{"LagrangeBasis", "[", 
      RowBox[{"index", ",", "q1"}], "]"}], ",", "data", ",", "q1"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "==", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{"InterpolatingPolynomial", "[", 
       RowBox[{"points", ",", "x", ",", " ", 
        RowBox[{"Modulus", "\[Rule]", "q1"}]}], "]"}], ",", 
      RowBox[{"Modulus", "\[Rule]", "q1"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Data", " ", "in", " ", "a", " ", "Roots", " ", "of", " ", "Unity", " ", 
     "Polynomial", " ", "Vector"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pointsW", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"basis", ",", "data"}], "}"}], "//", "Transpose"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"PolynomialTransformLC", "[", 
    RowBox[{
     RowBox[{"LagrangeBasis", "[", 
      RowBox[{"basis", ",", "q1"}], "]"}], ",", "data", ",", "q1"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "==", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{"InterpolatingPolynomial", "[", 
       RowBox[{"pointsW", ",", "x", ",", " ", 
        RowBox[{"Modulus", "\[Rule]", "q1"}]}], "]"}], ",", 
      RowBox[{"Modulus", "\[Rule]", "q1"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.877887960137702*^9, 3.877887974798851*^9}, {
  3.877894965424271*^9, 3.877895117774045*^9}, {3.877895411460164*^9, 
  3.877895442477269*^9}, {3.877895504853979*^9, 3.877895522069726*^9}, {
  3.87789555743752*^9, 3.877895567136281*^9}, {3.87789561355337*^9, 
  3.877895667537858*^9}, {3.877969357824314*^9, 3.8779693686690407`*^9}, {
  3.877970352563339*^9, 3.8779703711042137`*^9}, {3.877970622838347*^9, 
  3.877970633009941*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"14d7c4b0-e802-454a-a817-d8fa9dedd175"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"9", "+", 
        RowBox[{"3", " ", "x"}], "+", 
        SuperscriptBox["x", "2"], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "3"]}], "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["x", "4"]}]}]},
      {
       RowBox[{"9", "+", "x", "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["x", "3"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "4"]}]}]},
      {
       RowBox[{"9", "+", 
        RowBox[{"4", " ", "x"}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["x", "3"]}], "+", 
        SuperscriptBox["x", "4"]}]},
      {
       RowBox[{"9", "+", 
        RowBox[{"5", " ", "x"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        SuperscriptBox["x", "3"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["x", "4"]}]}]},
      {
       RowBox[{"9", "+", 
        RowBox[{"9", " ", "x"}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox["x", "3"]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox["x", "4"]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.877885494572914*^9, 3.877885573805275*^9}, 
   3.877885605615019*^9, {3.877885921492413*^9, 3.8778860607016153`*^9}, {
   3.87788610501578*^9, 3.877886135150716*^9}, {3.877886413432069*^9, 
   3.8778864170494003`*^9}, 3.877887371262659*^9, {3.877887408166155*^9, 
   3.877887426064007*^9}, {3.877887939972006*^9, 3.877887975559915*^9}, {
   3.877895028814156*^9, 3.877895065237384*^9}, {3.877895101675149*^9, 
   3.877895118649089*^9}, {3.877895420577642*^9, 3.877895442811808*^9}, {
   3.877895512736178*^9, 3.8778955267998*^9}, {3.8778955579001703`*^9, 
   3.877895569696108*^9}, 3.877895628849895*^9, 3.8778956681242857`*^9, 
   3.877899247968462*^9, 3.877969241204112*^9, {3.8779695622786837`*^9, 
   3.87796959088105*^9}, 3.877969707351019*^9, {3.8779703599139547`*^9, 
   3.8779703722139883`*^9}, {3.877970624685276*^9, 3.877970633541175*^9}, 
   3.878058420528326*^9, 3.8780592806620007`*^9, 3.878059326032219*^9},
 CellLabel->
  "Out[11]//MatrixForm=",ExpressionUUID->"107c6285-acd5-4778-b434-\
f21bee130fca"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.877885494572914*^9, 3.877885573805275*^9}, 
   3.877885605615019*^9, {3.877885921492413*^9, 3.8778860607016153`*^9}, {
   3.87788610501578*^9, 3.877886135150716*^9}, {3.877886413432069*^9, 
   3.8778864170494003`*^9}, 3.877887371262659*^9, {3.877887408166155*^9, 
   3.877887426064007*^9}, {3.877887939972006*^9, 3.877887975559915*^9}, {
   3.877895028814156*^9, 3.877895065237384*^9}, {3.877895101675149*^9, 
   3.877895118649089*^9}, {3.877895420577642*^9, 3.877895442811808*^9}, {
   3.877895512736178*^9, 3.8778955267998*^9}, {3.8778955579001703`*^9, 
   3.877895569696108*^9}, 3.877895628849895*^9, 3.8778956681242857`*^9, 
   3.877899247968462*^9, 3.877969241204112*^9, {3.8779695622786837`*^9, 
   3.87796959088105*^9}, 3.877969707351019*^9, {3.8779703599139547`*^9, 
   3.8779703722139883`*^9}, {3.877970624685276*^9, 3.877970633541175*^9}, 
   3.878058420528326*^9, 3.8780592806620007`*^9, 3.87805932603535*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"69963e2b-bade-4814-82b9-d43f38bb3c75"],

Cell[BoxData[
 RowBox[{"5", "+", 
  RowBox[{"9", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["x", "3"]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["x", "4"]}]}]], "Output",
 CellChangeTimes->{{3.877885494572914*^9, 3.877885573805275*^9}, 
   3.877885605615019*^9, {3.877885921492413*^9, 3.8778860607016153`*^9}, {
   3.87788610501578*^9, 3.877886135150716*^9}, {3.877886413432069*^9, 
   3.8778864170494003`*^9}, 3.877887371262659*^9, {3.877887408166155*^9, 
   3.877887426064007*^9}, {3.877887939972006*^9, 3.877887975559915*^9}, {
   3.877895028814156*^9, 3.877895065237384*^9}, {3.877895101675149*^9, 
   3.877895118649089*^9}, {3.877895420577642*^9, 3.877895442811808*^9}, {
   3.877895512736178*^9, 3.8778955267998*^9}, {3.8778955579001703`*^9, 
   3.877895569696108*^9}, 3.877895628849895*^9, 3.8778956681242857`*^9, 
   3.877899247968462*^9, 3.877969241204112*^9, {3.8779695622786837`*^9, 
   3.87796959088105*^9}, 3.877969707351019*^9, {3.8779703599139547`*^9, 
   3.8779703722139883`*^9}, {3.877970624685276*^9, 3.877970633541175*^9}, 
   3.878058420528326*^9, 3.8780592806620007`*^9, 3.8780593260381804`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"b83ef9f4-90f6-481e-85d6-84d0e093a521"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.877885494572914*^9, 3.877885573805275*^9}, 
   3.877885605615019*^9, {3.877885921492413*^9, 3.8778860607016153`*^9}, {
   3.87788610501578*^9, 3.877886135150716*^9}, {3.877886413432069*^9, 
   3.8778864170494003`*^9}, 3.877887371262659*^9, {3.877887408166155*^9, 
   3.877887426064007*^9}, {3.877887939972006*^9, 3.877887975559915*^9}, {
   3.877895028814156*^9, 3.877895065237384*^9}, {3.877895101675149*^9, 
   3.877895118649089*^9}, {3.877895420577642*^9, 3.877895442811808*^9}, {
   3.877895512736178*^9, 3.8778955267998*^9}, {3.8778955579001703`*^9, 
   3.877895569696108*^9}, 3.877895628849895*^9, 3.8778956681242857`*^9, 
   3.877899247968462*^9, 3.877969241204112*^9, {3.8779695622786837`*^9, 
   3.87796959088105*^9}, 3.877969707351019*^9, {3.8779703599139547`*^9, 
   3.8779703722139883`*^9}, {3.877970624685276*^9, 3.877970633541175*^9}, 
   3.878058420528326*^9, 3.8780592806620007`*^9, 3.878059326040864*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"98a1ef43-9e85-464b-af15-1d7ac843331c"],

Cell[BoxData[
 RowBox[{"10", "+", "x", "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  RowBox[{"8", " ", 
   SuperscriptBox["x", "3"]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["x", "4"]}]}]], "Output",
 CellChangeTimes->{{3.877885494572914*^9, 3.877885573805275*^9}, 
   3.877885605615019*^9, {3.877885921492413*^9, 3.8778860607016153`*^9}, {
   3.87788610501578*^9, 3.877886135150716*^9}, {3.877886413432069*^9, 
   3.8778864170494003`*^9}, 3.877887371262659*^9, {3.877887408166155*^9, 
   3.877887426064007*^9}, {3.877887939972006*^9, 3.877887975559915*^9}, {
   3.877895028814156*^9, 3.877895065237384*^9}, {3.877895101675149*^9, 
   3.877895118649089*^9}, {3.877895420577642*^9, 3.877895442811808*^9}, {
   3.877895512736178*^9, 3.8778955267998*^9}, {3.8778955579001703`*^9, 
   3.877895569696108*^9}, 3.877895628849895*^9, 3.8778956681242857`*^9, 
   3.877899247968462*^9, 3.877969241204112*^9, {3.8779695622786837`*^9, 
   3.87796959088105*^9}, 3.877969707351019*^9, {3.8779703599139547`*^9, 
   3.8779703722139883`*^9}, {3.877970624685276*^9, 3.877970633541175*^9}, 
   3.878058420528326*^9, 3.8780592806620007`*^9, 3.8780593260442343`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"34c8e313-1e97-4335-b062-6e1e6aa7ab91"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.877885494572914*^9, 3.877885573805275*^9}, 
   3.877885605615019*^9, {3.877885921492413*^9, 3.8778860607016153`*^9}, {
   3.87788610501578*^9, 3.877886135150716*^9}, {3.877886413432069*^9, 
   3.8778864170494003`*^9}, 3.877887371262659*^9, {3.877887408166155*^9, 
   3.877887426064007*^9}, {3.877887939972006*^9, 3.877887975559915*^9}, {
   3.877895028814156*^9, 3.877895065237384*^9}, {3.877895101675149*^9, 
   3.877895118649089*^9}, {3.877895420577642*^9, 3.877895442811808*^9}, {
   3.877895512736178*^9, 3.8778955267998*^9}, {3.8778955579001703`*^9, 
   3.877895569696108*^9}, 3.877895628849895*^9, 3.8778956681242857`*^9, 
   3.877899247968462*^9, 3.877969241204112*^9, {3.8779695622786837`*^9, 
   3.87796959088105*^9}, 3.877969707351019*^9, {3.8779703599139547`*^9, 
   3.8779703722139883`*^9}, {3.877970624685276*^9, 3.877970633541175*^9}, 
   3.878058420528326*^9, 3.8780592806620007`*^9, 3.87805932604712*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"ec47866e-ea79-45fb-8584-d138bd74cd70"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Barycentric Polynomials", "Section",
 CellChangeTimes->{{3.877861177229774*^9, 3.877861184681369*^9}, {
  3.877891990083577*^9, 3.877891992689661*^9}, {3.877894466178376*^9, 
  3.8778944691233263`*^9}, {3.8778947997401037`*^9, 
  3.877894802385957*^9}},ExpressionUUID->"d85b1e5f-09c3-4601-8ec8-\
6f42976a2d14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BarycentricWeight", "[", 
    RowBox[{"basis_", ",", "index_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "w", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PowerMod", "[", 
      RowBox[{
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"basis", "[", 
               RowBox[{"[", "index", "]"}], "]"}], "-", 
              RowBox[{"basis", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "basis", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", "index", "}"}]}], "]"}], ")"}]}], ",", 
       RowBox[{"-", "1"}], ",", "q1"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BarycentricWeights", "[", "bb_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", "w"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", "=", 
      RowBox[{"Expand", "[", 
       RowBox[{
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", 
            RowBox[{"bb", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "bb", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"Modulus", "\[Rule]", "q1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BarycentricWeight", "[", 
         RowBox[{"bb", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "bb", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"l", ",", "w"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.877893280499017*^9, 3.877893285548476*^9}, {
  3.877893858618855*^9, 3.877893858959298*^9}, {3.8778945942411633`*^9, 
  3.877894617396447*^9}, {3.877894747416122*^9, 3.877894758666519*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"5c761028-f836-45b6-a33d-7ef15fdfb806"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{"l", ",", "w"}], "}"}], "=", 
  RowBox[{
  "BarycentricWeights", "[", "basis", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Expand", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"x", "-", 
          RowBox[{"basis", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "basis", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"Modulus", "\[Rule]", "q1"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", 
  RowBox[{
   RowBox[{"l", "*", "%"}], ",", 
   RowBox[{"Modulus", "\[Rule]", "q1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.877891995202889*^9, 3.877892021282341*^9}, {
   3.877892118655717*^9, 3.8778923811911182`*^9}, {3.877892461257969*^9, 
   3.877892476772314*^9}, {3.877892526933817*^9, 3.8778925427734747`*^9}, {
   3.877892631509576*^9, 3.877892655371957*^9}, {3.877892701219648*^9, 
   3.8778927029965677`*^9}, {3.8778929302624474`*^9, 
   3.8778933426501627`*^9}, {3.8778933846889*^9, 3.877893456831429*^9}, {
   3.877893526295528*^9, 3.877893563539102*^9}, {3.877893716365266*^9, 
   3.877893733151119*^9}, {3.8778937697074547`*^9, 3.877893805545196*^9}, {
   3.877893887741309*^9, 3.877893959856701*^9}, {3.877893998205235*^9, 
   3.877894048395885*^9}, 3.877894119078329*^9, {3.877894774693592*^9, 
   3.8778947932897387`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"00ddd59f-867c-4dc1-8bfc-d4e9ef5f55cc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"10", "+", 
    SuperscriptBox["x", "5"]}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "4", ",", "1", ",", "3", ",", "9"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.877892221077374*^9, 3.8778922657879744`*^9}, 
   3.877892364839511*^9, 3.87789254326408*^9, {3.877892635920761*^9, 
   3.8778926558511267`*^9}, 3.877892703952794*^9, {3.877892964363344*^9, 
   3.877893042577662*^9}, {3.877893090265938*^9, 3.877893122882197*^9}, {
   3.877893172739257*^9, 3.877893200235186*^9}, {3.877893236442265*^9, 
   3.877893288988658*^9}, 3.877893342932537*^9, {3.87789344265285*^9, 
   3.877893457265977*^9}, {3.877893537592063*^9, 3.8778935638671227`*^9}, {
   3.877893717015085*^9, 3.877893733552066*^9}, {3.8778937724543543`*^9, 
   3.87789383107782*^9}, 3.8778938622945137`*^9, 3.8778938937989883`*^9, {
   3.8778939472696257`*^9, 3.877893960318336*^9}, {3.8778940025521812`*^9, 
   3.877894048841248*^9}, 3.877894120360775*^9, 3.877894375968759*^9, 
   3.8778944729437857`*^9, {3.87789459750134*^9, 3.877894623171543*^9}, {
   3.877894761183608*^9, 3.877894805983673*^9}, 3.877894850514203*^9, 
   3.877899269943522*^9, 3.87796926027503*^9, {3.877969567218587*^9, 
   3.877969592040613*^9}, 3.87796971608144*^9, 3.877970380970374*^9, 
   3.878059293836875*^9, 3.8780593261106586`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"806134ea-e11f-421a-8444-098c5aadbe51"],

Cell[BoxData[
 RowBox[{"10", "+", "x", "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["x", "2"]}], "+", 
  RowBox[{"8", " ", 
   SuperscriptBox["x", "3"]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["x", "4"]}]}]], "Output",
 CellChangeTimes->{{3.877892221077374*^9, 3.8778922657879744`*^9}, 
   3.877892364839511*^9, 3.87789254326408*^9, {3.877892635920761*^9, 
   3.8778926558511267`*^9}, 3.877892703952794*^9, {3.877892964363344*^9, 
   3.877893042577662*^9}, {3.877893090265938*^9, 3.877893122882197*^9}, {
   3.877893172739257*^9, 3.877893200235186*^9}, {3.877893236442265*^9, 
   3.877893288988658*^9}, 3.877893342932537*^9, {3.87789344265285*^9, 
   3.877893457265977*^9}, {3.877893537592063*^9, 3.8778935638671227`*^9}, {
   3.877893717015085*^9, 3.877893733552066*^9}, {3.8778937724543543`*^9, 
   3.87789383107782*^9}, 3.8778938622945137`*^9, 3.8778938937989883`*^9, {
   3.8778939472696257`*^9, 3.877893960318336*^9}, {3.8778940025521812`*^9, 
   3.877894048841248*^9}, 3.877894120360775*^9, 3.877894375968759*^9, 
   3.8778944729437857`*^9, {3.87789459750134*^9, 3.877894623171543*^9}, {
   3.877894761183608*^9, 3.877894805983673*^9}, 3.877894850514203*^9, 
   3.877899269943522*^9, 3.87796926027503*^9, {3.877969567218587*^9, 
   3.877969592040613*^9}, 3.87796971608144*^9, 3.877970380970374*^9, 
   3.878059293836875*^9, 3.878059326112996*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"57d38df4-0a1c-4ff1-8236-7f44917e21c5"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{714, 808},
WindowMargins->{{Automatic, 207}, {0, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 165, 3, 67, "Section",ExpressionUUID->"97238c83-4fd0-4175-bfec-ee253e351e0f"],
Cell[747, 27, 4811, 121, 577, "Input",ExpressionUUID->"71432c66-8a6c-439d-a415-a6b645790171"],
Cell[5561, 150, 877, 12, 30, "Input",ExpressionUUID->"1f01297b-db1f-4438-b754-dffb720aaaf1"],
Cell[CellGroupData[{
Cell[6463, 166, 3703, 92, 472, "Input",ExpressionUUID->"14d7c4b0-e802-454a-a817-d8fa9dedd175"],
Cell[10169, 260, 2817, 72, 126, "Output",ExpressionUUID->"107c6285-acd5-4778-b434-f21bee130fca"],
Cell[12989, 334, 1053, 14, 34, "Output",ExpressionUUID->"69963e2b-bade-4814-82b9-d43f38bb3c75"],
Cell[14045, 350, 1239, 21, 34, "Output",ExpressionUUID->"b83ef9f4-90f6-481e-85d6-84d0e093a521"],
Cell[15287, 373, 1054, 14, 34, "Output",ExpressionUUID->"98a1ef43-9e85-464b-af15-1d7ac843331c"],
Cell[16344, 389, 1250, 21, 34, "Output",ExpressionUUID->"34c8e313-1e97-4335-b062-6e1e6aa7ab91"],
Cell[17597, 412, 1053, 14, 34, "Output",ExpressionUUID->"ec47866e-ea79-45fb-8584-d138bd74cd70"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18699, 432, 316, 5, 67, "Section",ExpressionUUID->"d85b1e5f-09c3-4601-8ec8-6f42976a2d14"],
Cell[19018, 439, 2402, 63, 241, "Input",ExpressionUUID->"5c761028-f836-45b6-a33d-7ef15fdfb806"],
Cell[CellGroupData[{
Cell[21445, 506, 1735, 41, 94, "Input",ExpressionUUID->"00ddd59f-867c-4dc1-8bfc-d4e9ef5f55cc"],
Cell[23183, 549, 1421, 24, 37, "Output",ExpressionUUID->"806134ea-e11f-421a-8444-098c5aadbe51"],
Cell[24607, 575, 1438, 24, 34, "Output",ExpressionUUID->"57d38df4-0a1c-4ff1-8236-7f44917e21c5"]
}, Open  ]]
}, Open  ]]
}
]
*)

